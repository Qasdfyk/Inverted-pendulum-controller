\section{Eksperymenty}

Rozdział ten definiuje scenariusze testowe, przyjęte miary oceny jakości
sterowania oraz procedurę doboru nastaw regulatorów. Precyzyjne określenie
warunków eksperymentu jest kluczowe dla zapewnienia powtarzalności badań oraz
obiektywnego porównania testowanych algorytmów.

\subsection{Plan eksperymentów}

W~celu weryfikacji skuteczności strategii sterowania, przyjęto jednolity zestaw
testów symulacyjnych. Każdy z~zaimplementowanych regulatorów (PID-PID, PID-LQR, MPC, MPC-J2, Fuzzy-LQR, LMPC) poddany został badaniom w~następujących scenariuszach:

\begin{enumerate}
    \item \textbf{Eksperyment 1: Stabilizacja w~punkcie pracy (warunki nominalne).} \\
    Symulacja odpowiedzi układu na~niezerowe warunki początkowe przy braku
    zakłóceń zewnętrznych.
    \begin{itemize}
        \item Początkowy kąt wychylenia wahadła: $\theta(0) = 0{,}05$ rad ($\approx 2{,}87^\circ$).
        \item Początkowa pozycja wózka: $x(0) = 0$ m.
        \item Zerowe prędkości początkowe: $\dot{\theta}(0) = 0$, $\dot{x}(0) = 0$.
    \end{itemize}
    Wybór wartości $\theta(0) = 0{,}05$ rad podyktowany jest dwoma czynnikami:
    jest to wychylenie na~tyle małe, że mieści się w~obszarze stosowalności 
    modelu zlinearyzowanego (istotne dla LQR), a~jednocześnie wystarczająco duże,
    aby wymagać aktywnej interwencji regulatora. Wartość ta jest również powszechnie
    stosowana w~literaturze przedmiotu jako standardowy warunek testowy~\cite{Prasad2014}.
    Celem jest sprawdzenie zdolności regulatora do~sprowadzenia układu do~pionu
    ($\theta=0, x=0$) oraz ocena czasu regulacji i~przeregulowań.

    \item \textbf{Eksperyment 2: Odporność na~zakłócenia zewnętrzne.} \\
    Symulacja z~tymi samymi warunkami początkowymi, przy czym na~wahadło
    oddziałuje losowa siła zakłócająca $F_{\mathrm{w}}(t)$ (modelująca
    zakłócenia zewnętrzne) generowana zgodnie z~procedurą opisaną w~Rozdziale 3. 
    Przyjęto odchylenie standardowe siły zakłócającej $\sigma = 2{,}2$~N,
    co odpowiada wartości skutecznej (RMS) siły zakłócającej rzędu $2{,}2$~N
    i~chwilowym wartościom szczytowym do~$\pm 6{,}6$~N. Jest to poziom 
    zakłóceń stanowiący znaczące obciążenie dla układu sterowania 
    (kilka procent $F_{\max}$), lecz nieprzekraczający możliwości
    kompensacyjnych regulatorów. Test ten pozwala ocenić odporność 
    układu zamkniętego na zakłócenia zewnętrzne.

    \item \textbf{Eksperyment 3: Odporność na~zmianę parametrów modelu.} \\
    Symulacja w~warunkach nominalnych (bez zakłóceń), przy czym parametry
    rzeczywistego obiektu różnią się od~wartości użytych do~strojenia regulatorów.
    W~eksperymencie zwiększono masę wahadła $m$ o~10\%, co odpowiada sytuacji,
    w~której model użyty do~syntezy regulatora jest niedokładny względem
    rzeczywistego układu fizycznego:
    \begin{itemize}
        \item Nominalna masa wahadła: $m_{\mathrm{nom}} = 0{,}23$~kg.
        \item Rzeczywista masa wahadła: $m_{\mathrm{real}} = 0{,}253$~kg ($+10\%$).
    \end{itemize}
    Test ten ma~na~celu ocenę wrażliwości poszczególnych regulatorów na~niepewność
    parametryczną modelu --- kluczową właściwość w~zastosowaniach praktycznych,
    gdzie dokładne wartości parametrów fizycznych są~rzadko znane z~wysoką precyzją.
    Zmiana masy wahadła wpływa bezpośrednio na~dynamikę układu, modyfikując zarówno
    moment bezwładności, jak i~położenie środka ciężkości, co stanowi istotne
    wyzwanie dla algorytmów sterowania.
\end{enumerate}

\subsection{Badane algorytmy}

W~ramach eksperymentów przetestowano następujące regulatory (w~wersjach po
optymalizacji nastaw):
\begin{enumerate}
    \item \textbf{PID-PID} -- Równoległy układ dwóch regulatorów PID (gdzie $K_i=0$).
    \item \textbf{PID-LQR} -- Hybryda: PID dla wózka, LQR dla wahadła.
    \item \textbf{MPC} -- Nieliniowe sterowanie predykcyjne (NMPC) z~pełnym 
    modelem dynamiki i~całkowaniem metodą Rungego-Kutty 4.~rzędu.
    \item \textbf{MPC-J2} -- Wariant NMPC z~rozszerzoną funkcją kosztu $J_2$ 
    (uwzględniającą dodatkowo kwadrat bezwzględnej wartości sterowania).
    \item \textbf{LMPC} -- Liniowy regulator MPC wykorzystujący model zlinearyzowany.
    \item \textbf{Fuzzy-LQR} -- Regulator rozmyty Takagi-Sugeno wspomagany
    lokalnym LQR.
    
\end{enumerate}

\subsection{Wskaźniki jakości regulacji}

Do~ilościowej oceny jakości sterowania wykorzystano następujące wskaźniki
błędów, obliczane dla zdyskretyzowanych przebiegów kąta $\theta[k]$
($N$ próbek):

\begin{itemize}
    \item \textbf{MSE (Mean Squared Error)} -- Średni błąd kwadratowy, karający silniej duże odchyłki.
    \begin{equation}
        \mathrm{MSE} = \frac{1}{N}\sum_{k=1}^{N} (y[k] - y_{\mathrm{ref}}[k])^2
    \end{equation}

    \item \textbf{MAE (Mean Absolute Error)} -- Średni błąd bezwzględny, informujący o przeciętnym uchybie.
    \begin{equation}
        \mathrm{MAE} = \frac{1}{N}\sum_{k=1}^{N} |y[k] - y_{\mathrm{ref}}[k]|
    \end{equation}

    \item \textbf{ISE (Integral of Squared Error)} -- Całkowe kryterium kwadratowe, będące miarą energii uchybu w czasie ciągłym.
    \begin{equation}
        \mathrm{ISE} = \int_{0}^{T} (y(t) - y_{\mathrm{ref}}(t))^2 \, dt
    \end{equation}

    \item \textbf{IAE (Integral of Absolute Error)} -- Całkowe kryterium modułu błędu, akumulujące całkowity uchyb w czasie.
    \begin{equation}
        \mathrm{IAE} = \int_{0}^{T} |y(t) - y_{\mathrm{ref}}(t)| \, dt
    \end{equation}

    \item \textbf{Energia sterowania L2 ($E_{u, L2}$)} -- Koszt kwadratowy sterowania, powiązany z energią elektryczną/mechaniczną.
    \begin{equation}
        E_{u, L2} = \int_{0}^{T} u(t)^2 \, dt
    \end{equation}

    \item \textbf{Energia sterowania L1 ($E_{u, L1}$)} -- Koszt absolutny sterowania (zużycie paliwa/zasobów).
    \begin{equation}
        E_{u, L1} = \int_{0}^{T} |u(t)| \, dt
    \end{equation}

    \item \textbf{Czas regulacji $t_s$ (Settling Time)} -- Czas, po którym sygnał wyjściowy trwale wchodzi w~kanał tolerancji i~już go nie opuszcza. W~niniejszej pracy przyjęto tolerancję $\varepsilon = 2\%$ wartości początkowego wychylenia, tj. $|\theta| < 0{,}001$ rad dla kąta oraz $|x| < 0{,}002$ m dla pozycji.

    \item \textbf{Przeregulowanie $M_p$ (Overshoot)} -- Maksymalne procentowe odchylenie sygnału od wartości zadanej w odniesieniu do wartości skoku.
    \begin{equation}
        M_p = \frac{\max(y) - y_{\mathrm{ref}}}{y_{\mathrm{ref}}} \cdot 100\%
    \end{equation}

    \item \textbf{Uchyb ustalony $e_{ss}$ (Steady-state Error)} -- Średnia wartość uchybu w końcowej fazie symulacji (ostatnie 10\% czasu), określająca dokładność statyczną regulacji.

\end{itemize}

Dodatkowo analizie poddano charakterystyki jakościowe przebiegów czasowych,
takie jak czas regulacji (czas, po którym błąd trwale mieści się w paśmie
$\pm 2\%$) oraz maksymalne przeregulowanie.
