%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Bachelor's & Master's Thesis Template             %%
%% Copyleft by Artur M. Brodzki & Piotr Woźniak      %%
%% Faculty of Electronics and Information Technology %%
%% Warsaw University of Technology, 2019-2020        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[
    left=2.5cm,         % Sadly, generic margin parameter
    right=2.5cm,        % doesnt't work, as it is
    top=2.5cm,          % superseded by more specific
    bottom=3cm,         % left...bottom parameters.
    bindingoffset=6mm,  % Optional binding offset.
    nohyphenation=false % You may turn off hyphenation, if don't like.
]{eiti/eiti-thesis}

\langpol % Dla języka angielskiego mamy \langeng
\graphicspath{{img/}}             % Katalog z obrazkami.
\addbibresource{bibliografia.bib} % Plik .bib z bibliografią

% Pakiety do diagramów blokowych
\usepackage{tikz}
\usetikzlibrary{shapes, arrows.meta, positioning, calc, fit, backgrounds}

% Style dla diagramów blokowych
\tikzstyle{block} = [draw, fill=blue!10, rectangle, minimum height=2.5em, minimum width=4em, rounded corners=2pt]
\tikzstyle{bigblock} = [draw, fill=blue!10, rectangle, minimum height=3em, minimum width=6em, rounded corners=2pt]
\tikzstyle{sum} = [draw, fill=white, circle, minimum size=1.5em, inner sep=0pt]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{arrow} = [-{Stealth[length=2mm]}, thick]
\tikzstyle{line} = [thick]

\begin{document}

%--------------------------------------
% Strona tytułowa
%--------------------------------------
\EngineerThesis % Dla pracy inżynierskiej mamy \EngineerThesis
\instytut{Automatyki i Informatyki Stosowanej}
\kierunek{Automatyka i Robotyka}
% \specjalnosc{XXXXXX}
\title{
    Efektywny układ stabilizacji odwróconego wahadła na wózku
}
\engtitle{ % Tytuł po angielsku do angielskiego streszczenia
    Effective stabilisation system of the inverted pendulum on the cart
}
\author{Adam Sokołowski}
\album{324892}
\promotor{mgr inż. Robert Nebeluk}
\date{\the\year}
\maketitle

%--------------------------------------
% Streszczenie po polsku
%--------------------------------------
\cleardoublepage
\streszczenie
% W pracy przeprowadzono analizę i porównanie wybranych metod sterowania odwróconym wahadłem na wózku — klasycznym przykładem nieliniowego i niestabilnego układu dynamicznego. Celem badań było opracowanie środowiska symulacyjnego umożliwiającego ocenę skuteczności różnych algorytmów regulacji oraz ich odporności na zakłócenia zewnętrzne. W ramach pracy zaimplementowano i przetestowano następujące podejścia: klasyczny regulator kaskadowy PID--PID, układ złożony PID--LQR, regulator LQR dla całego systemu, sterowanie predykcyjne modelowe MPC bez ograniczeń (MPC\_NO) w kilku wariantach funkcji kosztu, oraz regulator rozmyty Takagi--Sugeno.

% Dla każdego z rozważanych regulatorów wykonano symulacje numeryczne w warunkach nominalnych oraz w obecności zakłóceń poziomych działających na wózek. Analizie poddano przebiegi kątów i położeń, a także obliczono wskaźniki jakości regulacji: średni błąd kwadratowy (MSE), średni błąd bezwzględny (MAE), czas regulacji, przeregulowanie, energię sygnału sterującego oraz średni czas obliczeń. Wyniki przedstawiono w postaci wykresów i tabel umożliwiających obiektywne porównanie metod.

% Otrzymane rezultaty wskazują, że włączenie metod optymalnych i predykcyjnych pozwala znacząco poprawić stabilność oraz odporność układu w porównaniu z klasycznym sterowaniem PID. Regulator MPC zapewniał najkrótszy czas stabilizacji przy zachowaniu umiarkowanego kosztu sterowania, natomiast regulator rozmyty Takagi--Sugeno wykazał dobrą adaptacyjność przy zmiennych warunkach pracy. Opracowane środowisko może stanowić podstawę do dalszych badań nad sterowaniem nieliniowym, w tym nad integracją metod rozmytych, optymalnych i predykcyjnych.
Celem pracy było zaprojektowanie autorskiego środowiska symulacyjnego oraz przeprowadzenie 
wielokryterialnej analizy porównawczej algorytmów sterowania dla nieliniowego układu odwróconego
wahadła na wózku. W ramach badań zaimplementowano i przetestowano cztery strategie sterowania: 
klasyczny regulator kaskadowy PD-PD, układ hybrydowy PD-LQR, nieliniowe sterowanie predykcyjne (MPC) 
w dwóch wariantach funkcji kosztu oraz sterownik rozmyty typu Takagi-Sugeno wspomagany regulatorem LQR 
(Fuzzy-LQR). Badania przeprowadzono w środowisku języka Python, wykorzystując pełny model nieliniowy obiektu. 
Skuteczność algorytmów zweryfikowano w dwóch scenariuszach: stabilizacji w punkcie pracy oraz pracy w warunkach 
zakłóceń zewnętrznych (symulacja wiatru). Analiza wyników wykazała, że nie istnieje jeden uniwersalny regulator
dla wszystkich zastosowań. Sterownik Fuzzy-LQR zapewnił najwyższą precyzję stabilizacji i odporność na 
zakłócenia, jednak odbyło się to kosztem bardzo wysokiego zużycia energii sterowania. Z kolei regulator 
MPC okazał się rozwiązaniem najbardziej ekonomicznym, zapewniając płynność ruchu i uwzględnienie ograniczeń
fizycznych napędu, co jest kluczowe w systemach rzeczywistych. Układ PD-LQR stanowił kompromis między 
złożonością obliczeniową a jakością regulacji, przewyższając klasyczne podejście PID.
\slowakluczowe odwrócone wahadło,\allowbreak regulator PID,\allowbreak regulator LQR,\allowbreak regulator MPC,\allowbreak Takagi\allowbreak--\allowbreak Sugeno,\allowbreak sterowanie predykcyjne,\allowbreak sterowanie optymalne,\allowbreak zakłócenia,\allowbreak stabilizacja,\allowbreak symulacja,\allowbreak układ nieliniowy

%--------------------------------------
% Streszczenie po angielsku
%--------------------------------------
\newpage
\abstract
% This thesis presents the analysis and comparison of several control methods for an inverted pendulum on a cart — a classical benchmark of nonlinear and unstable dynamics. The aim of the study was to develop a simulation framework enabling an objective evaluation of different control algorithms and their robustness to external disturbances. The implemented control strategies included a classical cascade PID--PID controller, a combined PID--LQR scheme, a full-state LQR controller, a model predictive controller without constraints (MPC\_NO) with alternative cost functions, and a fuzzy Takagi--Sugeno controller.

% For each controller, numerical simulations were performed under nominal conditions and under horizontal disturbance forces acting on the cart. The responses of the pendulum angle and cart position were analyzed, and several performance indices were calculated: mean squared error (MSE), mean absolute error (MAE), settling time, overshoot, control energy, and average computation time. The results were visualized in plots and summarized in tables, allowing a comprehensive comparison of control quality and computational efficiency.

% The obtained results show that introducing optimal and predictive control significantly improves system stability and robustness compared to classical PID regulation. The MPC controller provided the fastest stabilization with a moderate control effort, while the Takagi--Sugeno fuzzy controller demonstrated good adaptability under varying operating conditions. The developed simulation environment constitutes a solid foundation for further research on nonlinear control, particularly on hybrid combinations of fuzzy, optimal, and predictive methods.
The aim of this thesis was to design a custom simulation environment and 
conduct a multi-criteria comparative analysis of control algorithms for a 
nonlinear inverted pendulum system on a cart. As part of the research, four 
control strategies were implemented and tested: a classical cascade PD-PD 
controller, a hybrid PD-LQR system, nonlinear Model Predictive Control (MPC) 
with two cost function variants, and a Takagi-Sugeno fuzzy controller supported 
by LQR (Fuzzy-LQR). The study was conducted in a Python environment using a full 
nonlinear model of the object. The effectiveness of the algorithms was verified 
in two scenarios: stabilization at the operating point and operation under external 
disturbances (simulated wind). The analysis of the results showed that there is 
no single universal controller for all applications. The Fuzzy-LQR controller 
provided the highest stabilization precision and robustness to disturbances, but 
at the cost of very high control energy consumption. On the other hand, the MPC 
controller proved to be the most economical solution, ensuring smooth motion and 
compliance with physical drive constraints, which is crucial in real-world systems. 
The PD-LQR system represented a compromise between computational complexity and control 
quality, outperforming the classical PID approach.
\keywords inverted pendulum, PID controller, LQR controller, MPC controller, Takagi\allowbreak--\allowbreak Sugeno, predictive control, optimal control, disturbances, stabilization, nonlinear system, simulation

%--------------------------------------
% Oświadczenie o autorstwie
%--------------------------------------
\cleardoublepage  % Zaczynamy od nieparzystej strony
%\pagestyle{plain}
%\makeauthorship

%--------------------------------------
% Spis treści
%--------------------------------------
\cleardoublepage % Zaczynamy od nieparzystej strony
\tableofcontents

%--------------------------------------
% Rozdziały
%--------------------------------------
\cleardoublepage % Zaczynamy od nieparzystej strony
\pagestyle{headings}

%\input{tex/1-wstep}         % Wygodnie jest trzymać każdy rozdział w osobnym pliku.
%\input{tex/2-de-finibus}    % Umożliwia to również łatwą migrację do nowej wersji szablonu:
%\input{tex/3-code-listings} % wystarczy podmienić swoje pliki main.tex i eiti-thesis.cls
                            % na nowe wersje, a cały tekst pracy pozostaje nienaruszony.

\input{tex/wstep}
\newpage 
\input{tex/matma}
\newpage
\input{tex/srodowisko}
\newpage
\input{tex/sterowanie}
\newpage
\input{tex/eksperymenty}
\newpage
\input{tex/badania_wyniki}
\newpage
\input{tex/podsumowanie}

%--------------------------------------------
% Literatura
%--------------------------------------------
\cleardoublepage % Zaczynamy od nieparzystej strony
\printbibliography

%--------------------------------------------
% Spisy (opcjonalne)
%--------------------------------------------
\newpage
\pagestyle{plain}

% Wykaz symboli i skrótów.
% Pamiętaj, żeby posortować symbole alfabetycznie
% we własnym zakresie. Ponieważ mało kto używa takiego wykazu,
% uznałem, że robienie automatycznie sortowanej listy
% na poziomie LaTeXa to za duży overkill.
% Makro \acronymlist generuje właściwy tytuł sekcji,
% w zależności od języka.
% Makro \acronym dodaje skrót/symbol do listy,
% zapewniając podstawowe formatowanie.
% //AB
\vspace{0.8cm}
\acronymlist
\acronym{$x$}{Położenie wózka [m]}
\acronym{$\dot{x}$}{Prędkość wózka [m/s]}
\acronym{$\varphi$}{Kąt odchylenia wahadła od pionu [rad]}
\acronym{$\dot{\varphi}$}{Prędkość kątowa wahadła [rad/s]}
\acronym{$u$}{Sygnał sterujący (siła działająca na wózek) [N]}
\acronym{LQR}{Linear-Quadratic Regulator - regulator liniowo-kwadratowy}
\acronym{PID}{Proporcjonalno-Całkująco-Różniczkujący regulator}
\acronym{MSE}{Mean Squared Error - średni błąd kwadratowy}
\acronym{MAE}{Mean Absolute Error - średni błąd bezwzględny}
\acronym{$\Delta t$}{Krok czasowy symulacji [s]}
\acronym{$N$}{Liczba próbek w sygnale dyskretnym}


\listoffigurestoc     % Spis rysunków.
\vspace{1cm}          % vertical space
\listoftablestoc      % Spis tabel.
\vspace{1cm}          % vertical space
% \listofappendicestoc  % Spis załączników

% Załączniki
% \newpage
% \appendix{Nazwa załącznika 1}
% \lipsum[1-8]

% \newpage
% \appendix{Nazwa załącznika 2}
% \lipsum[1-4]

% Używając powyższych spisów jako szablonu,
% możesz tu dodać swój własny wykaz bądź listę,
% np. spis algorytmów.

\end{document} % Dobranoc.
